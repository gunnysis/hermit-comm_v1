# E2E: 관리자가 초대 코드 "테스트"인 그룹 생성 (groups-join-by-invite.yaml 사전 조건)
# 전제: 익명 세션에서 시작 (launch-app-fresh)
# 환경 변수: MAESTRO_ADMIN_EMAIL, MAESTRO_ADMIN_PASSWORD (.env 참조)
appId: com.gns.hermitcomm.dev
---
- runFlow: common/launch-app-fresh.yaml

# 설정 → 관리자 로그인
- tapOn: "설정"
- extendedWaitUntil:
    visible: "운영자 관리 페이지"
    timeout: 5000
- tapOn: "운영자 관리 페이지"

# 로그인 화면 로드 대기 (익명 세션 보장으로 로그인 화면 기대)
- extendedWaitUntil:
    visible: "관리자 로그인"
    timeout: 15000
- extendedWaitUntil:
    visible: "이메일"
    timeout: 5000

# 로그인 (영어 키보드로 전환 후 입력)
- tapOn: "admin@example.com"
- runFlow: common/ensure-english-keyboard.yaml
- inputText: "${MAESTRO_ADMIN_EMAIL}"
- tapOn:
    text: "비밀번호"
    index: 1
- runFlow: common/ensure-english-keyboard.yaml
- inputText: "${MAESTRO_ADMIN_PASSWORD}"
- scrollUntilVisible:
    element: "로그인"
    direction: DOWN
    timeout: 5000
- tapOn: "로그인"

- extendedWaitUntil:
    visible: "그룹 게시판 생성"
    timeout: 10000

# 그룹 생성 (영어 입력 후 한글 "테스트" 입력)
- tapOn: "예: 2025 봄 프로그램"
- runFlow: common/ensure-english-keyboard.yaml
- inputText: "E2E 초대테스트"
- tapOn: "예: WELCOME2025"
- runFlow: common/ensure-korean-keyboard.yaml
- inputText: "테스트"
- tapOn:
    text: "그룹에 대한 간단한 설명"
    optional: true
- runFlow: common/ensure-english-keyboard.yaml
- inputText: "초대 코드 테스트용 그룹 (코드: 테스트)"

- tapOn: "그룹 생성"
- extendedWaitUntil:
    visible: "그룹 생성 완료"
    timeout: 10000
- tapOn: "확인"

- assertVisible: "E2E 초대테스트"
