# Cursor Agent 사용 가이드

이 문서는 이 저장소에서 **Cursor Agent**와 **Claude**(CLI·claude.ai/code)를 함께 쓸 때, 각 도구의 장단점을 알고 효율적으로 나누어 쓰기 위한 안내입니다.

---

## Claude vs Cursor Agent 비교

| 구분 | Claude (CLI / claude.ai/code) | Cursor Agent |
|------|-------------------------------|---------------|
| **역할** | 대화·설계·검토·제안 | 코드 수정·명령 실행·자동 적용 |
| **수정 방식** | 텍스트로 제안 → 사용자가 복사·적용 | 도구로 파일 수정·터미널 실행을 직접 수행 |
| **컨텍스트** | 대화·붙여 넣은 코드 위주, 상대적으로 단순 | 워크스페이스 규칙·열린 파일·linter·git·MCP 등 풍부 |
| **잘못됐을 때** | 제안만 하므로 적용하지 않으면 영향 없음 | 이미 수정·실행된 결과가 남아 에러·오탐으로 이어짐 |
| **강점** | 아키텍처 논의, RLS/마이그레이션 설계, "이렇게 하면 될까?" 검토, 긴 설명·문서 작성 | 구체적 리팩터·버그 수정·다중 파일 수정·테스트/타입 검증 실행 |
| **약점** | 직접 수정·실행이 없어 적용 단계가 수동 | 컨텍스트 과다·과잉 수정·도구 사용 오류 가능성 |

**요약**: Claude는 “생각·설계·제안”에, Cursor Agent는 “실제 코드 변경·검증 실행”에 두는 것이 효율적입니다.

---

## 효율적으로 둘을 나누어 쓰기

- **Claude에 맡기기**
  - RLS 정책·마이그레이션·E2E 시나리오 설계, “이렇게 하면 될까?” 검토
  - 아키텍처·데이터 흐름 논의, 문서 초안·주석 문구 작성
  - 제안만 받고 **직접 적용**할 작업(고위험 구역 포함)
- **Cursor Agent에 맡기기**
  - “이 파일 이 함수만 수정해줘”처럼 **범위가 명확한** 코드/테스트/리팩터
  - 수정 후 `npm test`, `npx tsc --noEmit` 실행까지 한 번에 하고 싶을 때
  - 여러 파일을 한 번에 건드리는 리팩터(요청 시 파일·목표를 구체적으로 적기)
- **혼합 플로우**
  1. Claude로 설계·SQL·정책 초안을 받고 검토한 뒤,
  2. 적용은 직접 하거나, 적용할 부분만 Cursor Agent에게 “이 블록만 반영해줘”처럼 구체적으로 요청한다.

---

## 1. 언제 Agent vs Ask를 쓸지 (Cursor 내)

| 모드 | 사용할 때 |
|------|-----------|
| **Agent** | 구체적인 코드/테스트/리팩터 요청, 수정 범위가 명확할 때 |
| **Ask** | RLS 정책·마이그레이션·E2E 시나리오 설계, "이렇게 하면 될까?" 검토, 제안만 받고 직접 적용할 때 |

## 2. 요청할 때 습관

- **파일·함수·라인을 구체적으로** 적기 (예: `src/features/posts/hooks/useCreatePost.ts` 92번 라인 근처).
- **한 요청에 목표 하나**.
- "건드리지 말 것"이 있으면 명시 (예: `supabase/migrations` 수정 제외).

## 3. Agent가 따르는 규칙 요약

- **검증**: 수정 후 `npm test`·`npx tsc --noEmit` 실행. 문서·설정만 수정한 경우는 검증 생략 가능하다고 안내.
- **최소 변경**: 요청 범위 밖 수정·불필요한 개선 금지.
- **도메인별**: `.cursor/rules/`의 supabase-rls, api-invalidation, anonymous-display 등 참고.

## 4. 프롬프트 예시

**좋은 예**

- "`useCreatePost.ts`에서 groupPosts invalidate 시 queryKey를 훅과 맞춰줘."
- "`PostCard.tsx` 42번 라인 제목 잘림 스타일만 수정해줘."

**나쁜 예**

- "게시판 다 고쳐줘." (범위·목표 불명확)
- "코드 정리해줘." (무엇을 어떻게 정리할지 불명확)

## 5. 고위험 구역

다음 구역을 수정할 때는 한 단계씩 진행하거나, Ask 모드로 제안만 받고 직접 적용하는 것을 권장한다.

- RLS/DB: `supabase/migrations/002_rls.sql`, `src/shared/lib/api/posts.ts`, `src/shared/lib/api/comments.ts`
- 익명 로직: `src/shared/lib/anonymous.ts`
- 라우팅: `src/app/admin/_layout.tsx`
- E2E: `.maestro/` 시나리오

## 6. 문제가 생겼을 때

- **범위가 너무 컸다면**: 작업을 나누어 다시 요청한다.
- **RLS/DB/E2E 관련**: Ask 모드로 제안만 받고 직접 적용하는 것을 고려한다.
- **Agent가 잘못 수정했다면**: "되돌려줘", "그 부분만 수정해줘"처럼 구체적으로 정정하면, Agent는 재논쟁 없이 수정·되돌리기 방법을 제안한다.

---

## 요약: Claude vs Cursor Agent 선택

| 하고 싶은 일 | 추천 |
|-------------|------|
| RLS·마이그레이션·E2E 설계, "이렇게 하면 될까?" 검토 | **Claude** (제안만 받고 직접 적용) |
| 문서·주석·아키텍처 논의 | **Claude** |
| "이 파일/이 함수만 고쳐줘", 테스트·타입까지 실행 | **Cursor Agent** |
| 여러 파일 리팩터(범위·목표를 구체적으로 적었을 때) | **Cursor Agent** |
| 고위험 구역 수정 | **Claude로 설계** → 검토 후 직접 적용 또는 Agent에 **구체적 블록만** 요청 |
